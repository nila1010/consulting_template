---
import Button from "./Button.astro";
import { Icon } from "astro-icon/components";

const pathname = new URL(Astro.request.url).pathname;
const last = pathname.lastIndexOf("/");
const currentPath = pathname.slice(1, last);
---

<nav role="navigation" aria-label="Main menu">
  <div>
    <Icon name="ask_experts_icon" />
    <p>AskExperts</p>
  </div>
  <div class="menu" aria-expanded="false" aria-controls="main-menu">
    <span></span><span></span><span></span><span></span>

    <ul id="main-menu">
      <a href="/"><li class={currentPath === "" ? "active" : ""}>About</li></a>
      <a href="/servicesingle"><li class={currentPath === "servicesingle" ? "active" : ""}>Service Single</li></a>
      <a href="/team"><li class={currentPath === "team" ? "active" : ""}>Team</li></a>
      <a href="/casestudysingle"><li class={currentPath === "casestudysingle" ? "active" : ""}>Case Study Single</li></a>
    </ul>
  </div>
  <Button btnIcon="true" buttonStyle="white" btnSize="small" text="+ (888) 452 1505" />
</nav>

<style>
  [data-icon] {
    width: 1.85869rem;
    height: 1.80669rem;
  }

  nav {
    position: relative;
    padding-block: 1.5rem;
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding-inline: max(2rem, 50% - var(--content) / 2);
    background: rgb(62 61 61 / 91%);
    color: #fff;
  }
  div:first-child {
    display: flex;
    gap: 0.3rem;
    p {
      font-size: 1.875rem;
    }
  }

  /* [aria-expanded="true"] */
  .menu {
    span {
      display: none;
    }

    ul {
      padding: 0;
      display: flex;
      gap: 2.5rem;

      li {
        list-style: circle;
      }

      li:hover {
        color: var(--secondary-color-3);
        cursor: pointer;
        transition: all 0.3s ease;
      }
      .active {
        color: var(--secondary-color-3);
        list-style: unset;
      }
      a {
        all: unset;
      }
    }
  }

  @media (width < 940px) {
    nav {
      button {
        display: none;
      }
    }
  }
  @media (width < 740px) {
    div {
      p {
        display: none;
      }
    }
  }
  @media (width < 600px) {
    [aria-expanded="false"] {
      position: relative;
      inline-size: 50px;
      block-size: 60px;

      span {
        display: block;
        position: absolute;
        block-size: 5px;
        inline-size: 50px;
        background: var(--secondary-color-2);
      }
      span:nth-child(1) {
        top: 10px;
      }

      span:nth-child(2),
      span:nth-child(3) {
        top: 25px;
      }

      span:nth-child(4) {
        top: 40px;
      }
      ul {
        display: none;
      }
    }
    div {
      p {
        display: block;
      }
    }

    [aria-expanded="true"] {
      block-size: 60px;
      position: relative;
      display: flex;
      place-content: end;

      ul {
        position: absolute;
        transform: translateX(100%);
        background: rgb(62 61 61);
        z-index: 1;
        margin-block-start: 4rem;
        min-inline-size: 15rem;
        padding: 2cqi 6cqi;
        animation-name: slidein;
        animation-duration: 1s;
        animation-fill-mode: forwards;
        display: grid;
        gap: 1rem;
      }

      span {
        display: block;
        position: absolute;
        height: 5px;
        width: 50px;
        background: var(--secondary-color-2);
        transition: 0.3s ease-in;
      }

      span:nth-child(1) {
        top: 18px;
        width: 0%;
        opacity: 0;
      }

      span:nth-child(2) {
        transform: rotate(45deg);
        top: 26px;
      }

      span:nth-child(3) {
        transform: rotate(-45deg);
        top: 26px;
      }

      span:nth-child(4) {
        top: 18px;
        width: 0%;
        opacity: 0;
      }
    }
  }

  @keyframes slidein {
    to {
      transform: translateX(30%);
    }
  }
</style>

<script>
  const navMenu = document.querySelector(".menu");
  navMenu.addEventListener("click", () => {
    if (navMenu.getAttribute("aria-expanded") === "true") {
      console.log("click");
      navMenu.setAttribute("aria-expanded", "false");
    } else navMenu.setAttribute("aria-expanded", "true");
  });

  let checkWidth = window.matchMedia("(max-width: 600px)");
  checkWidth.addEventListener("change", () => {
    if (checkWidth.matches) {
      navMenu.setAttribute("aria-expanded", "false");
    } else {
      navMenu.setAttribute("aria-expanded", "true");
    }
  });
</script>
